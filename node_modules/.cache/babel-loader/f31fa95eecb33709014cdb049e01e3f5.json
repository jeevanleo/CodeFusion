{"ast":null,"code":"import _asyncToGenerator from\"/Users/jeevansatyam/Desktop/realtime-code-editor-main/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jeevansatyam/Desktop/realtime-code-editor-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/jeevansatyam/Desktop/realtime-code-editor-main/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useRef,useEffect}from\"react\";import toast from\"react-hot-toast\";import Client from\"../components/Client\";import Editor from\"../components/Editor\";import{language,cmtheme}from\"../../src/atoms\";import{useRecoilState}from\"recoil\";import ACTIONS from\"../Actions\";import{initSocket}from\"../socket\";import{useLocation,useNavigate,Navigate,useParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var EditorPage=function EditorPage(){var _useRecoilState=useRecoilState(language),_useRecoilState2=_slicedToArray(_useRecoilState,2),lang=_useRecoilState2[0],setLang=_useRecoilState2[1];var _useRecoilState3=useRecoilState(cmtheme),_useRecoilState4=_slicedToArray(_useRecoilState3,2),them=_useRecoilState4[0],setThem=_useRecoilState4[1];var _useState=useState([]),_useState2=_slicedToArray(_useState,2),clients=_useState2[0],setClients=_useState2[1];var socketRef=useRef(null);var codeRef=useRef(null);var location=useLocation();var _useParams=useParams(),roomId=_useParams.roomId;var reactNavigator=useNavigate();useEffect(function(){var init=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _location$state;var handleErrors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:handleErrors=function _handleErrors(e){console.log(\"socket error\",e);toast.error(\"Socket connection failed, try again later.\");reactNavigator(\"/\");};_context.next=3;return initSocket();case 3:socketRef.current=_context.sent;socketRef.current.on(\"connect_error\",function(err){return handleErrors(err);});socketRef.current.on(\"connect_failed\",function(err){return handleErrors(err);});socketRef.current.emit(ACTIONS.JOIN,{roomId:roomId,username:(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.username});// Listening for joined event\nsocketRef.current.on(ACTIONS.JOINED,function(_ref2){var _location$state2;var clients=_ref2.clients,username=_ref2.username,socketId=_ref2.socketId;if(username!==((_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.username)){toast.success(\"\".concat(username,\" joined the room.\"));console.log(\"\".concat(username,\" joined\"));}setClients(clients);socketRef.current.emit(ACTIONS.SYNC_CODE,{code:codeRef.current,socketId:socketId});});// Listening for disconnected\nsocketRef.current.on(ACTIONS.DISCONNECTED,function(_ref3){var socketId=_ref3.socketId,username=_ref3.username;toast.success(\"\".concat(username,\" left the room.\"));setClients(function(prev){return prev.filter(function(client){return client.socketId!==socketId;});});});case 9:case\"end\":return _context.stop();}}},_callee);}));return function init(){return _ref.apply(this,arguments);};}();init();return function(){socketRef.current.off(ACTIONS.JOINED);socketRef.current.off(ACTIONS.DISCONNECTED);socketRef.current.disconnect();};},[]);function copyRoomId(){return _copyRoomId.apply(this,arguments);}function _copyRoomId(){_copyRoomId=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return navigator.clipboard.writeText(roomId);case 3:toast.success(\"Room ID has been copied to your clipboard\");_context2.next=10;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);toast.error(\"Could not copy the Room ID\");console.error(_context2.t0);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return _copyRoomId.apply(this,arguments);}function leaveRoom(){reactNavigator(\"/\");}if(!location.state){return/*#__PURE__*/_jsx(Navigate,{to:\"/\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"mainWrap\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"aside\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"asideInner\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsx(\"img\",{className:\"logoImage\",src:\"/code-sync.png\",alt:\"logo\"})}),/*#__PURE__*/_jsx(\"h3\",{children:\"Connected\"}),/*#__PURE__*/_jsx(\"div\",{className:\"clientsList\",children:clients.map(function(client){return/*#__PURE__*/_jsx(Client,{username:client.username},client.socketId);})})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Select Language:\",/*#__PURE__*/_jsxs(\"select\",{value:lang,onChange:function onChange(e){setLang(e.target.value);window.location.reload();},className:\"seLang\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"clike\",children:\"C / C++ / C#\"}),/*#__PURE__*/_jsx(\"option\",{value:\"css\",children:\"CSS\"}),/*#__PURE__*/_jsx(\"option\",{value:\"dart\",children:\"Dart\"}),/*#__PURE__*/_jsx(\"option\",{value:\"django\",children:\"Django\"}),/*#__PURE__*/_jsx(\"option\",{value:\"dockerfile\",children:\"Dockerfile\"}),/*#__PURE__*/_jsx(\"option\",{value:\"go\",children:\"Go\"}),/*#__PURE__*/_jsx(\"option\",{value:\"htmlmixed\",children:\"HTML-mixed\"}),/*#__PURE__*/_jsx(\"option\",{value:\"javascript\",children:\"JavaScript\"}),/*#__PURE__*/_jsx(\"option\",{value:\"jsx\",children:\"JSX\"}),/*#__PURE__*/_jsx(\"option\",{value:\"markdown\",children:\"Markdown\"}),/*#__PURE__*/_jsx(\"option\",{value:\"php\",children:\"PHP\"}),/*#__PURE__*/_jsx(\"option\",{value:\"python\",children:\"Python\"}),/*#__PURE__*/_jsx(\"option\",{value:\"r\",children:\"R\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rust\",children:\"Rust\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ruby\",children:\"Ruby\"}),/*#__PURE__*/_jsx(\"option\",{value:\"sass\",children:\"Sass\"}),/*#__PURE__*/_jsx(\"option\",{value:\"shell\",children:\"Shell\"}),/*#__PURE__*/_jsx(\"option\",{value:\"sql\",children:\"SQL\"}),/*#__PURE__*/_jsx(\"option\",{value:\"swift\",children:\"Swift\"}),/*#__PURE__*/_jsx(\"option\",{value:\"xml\",children:\"XML\"}),/*#__PURE__*/_jsx(\"option\",{value:\"yaml\",children:\"yaml\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Select Theme:\",/*#__PURE__*/_jsxs(\"select\",{value:them,onChange:function onChange(e){setThem(e.target.value);window.location.reload();},className:\"seLang\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"default\",children:\"default\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3024-day\",children:\"3024-day\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3024-night\",children:\"3024-night\"}),/*#__PURE__*/_jsx(\"option\",{value:\"abbott\",children:\"abbott\"}),/*#__PURE__*/_jsx(\"option\",{value:\"abcdef\",children:\"abcdef\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ambiance\",children:\"ambiance\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ayu-dark\",children:\"ayu-dark\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ayu-mirage\",children:\"ayu-mirage\"}),/*#__PURE__*/_jsx(\"option\",{value:\"base16-dark\",children:\"base16-dark\"}),/*#__PURE__*/_jsx(\"option\",{value:\"base16-light\",children:\"base16-light\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bespin\",children:\"bespin\"}),/*#__PURE__*/_jsx(\"option\",{value:\"blackboard\",children:\"blackboard\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cobalt\",children:\"cobalt\"}),/*#__PURE__*/_jsx(\"option\",{value:\"colorforth\",children:\"colorforth\"}),/*#__PURE__*/_jsx(\"option\",{value:\"darcula\",children:\"darcula\"}),/*#__PURE__*/_jsx(\"option\",{value:\"duotone-dark\",children:\"duotone-dark\"}),/*#__PURE__*/_jsx(\"option\",{value:\"duotone-light\",children:\"duotone-light\"}),/*#__PURE__*/_jsx(\"option\",{value:\"eclipse\",children:\"eclipse\"}),/*#__PURE__*/_jsx(\"option\",{value:\"elegant\",children:\"elegant\"}),/*#__PURE__*/_jsx(\"option\",{value:\"erlang-dark\",children:\"erlang-dark\"}),/*#__PURE__*/_jsx(\"option\",{value:\"gruvbox-dark\",children:\"gruvbox-dark\"}),/*#__PURE__*/_jsx(\"option\",{value:\"hopscotch\",children:\"hopscotch\"}),/*#__PURE__*/_jsx(\"option\",{value:\"icecoder\",children:\"icecoder\"}),/*#__PURE__*/_jsx(\"option\",{value:\"idea\",children:\"idea\"}),/*#__PURE__*/_jsx(\"option\",{value:\"isotope\",children:\"isotope\"}),/*#__PURE__*/_jsx(\"option\",{value:\"juejin\",children:\"juejin\"}),/*#__PURE__*/_jsx(\"option\",{value:\"lesser-dark\",children:\"lesser-dark\"}),/*#__PURE__*/_jsx(\"option\",{value:\"liquibyte\",children:\"liquibyte\"}),/*#__PURE__*/_jsx(\"option\",{value:\"lucario\",children:\"lucario\"}),/*#__PURE__*/_jsx(\"option\",{value:\"material\",children:\"material\"}),/*#__PURE__*/_jsx(\"option\",{value:\"material-darker\",children:\"material-darker\"}),/*#__PURE__*/_jsx(\"option\",{value:\"material-palenight\",children:\"material-palenight\"}),/*#__PURE__*/_jsx(\"option\",{value:\"material-ocean\",children:\"material-ocean\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mbo\",children:\"mbo\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mdn-like\",children:\"mdn-like\"}),/*#__PURE__*/_jsx(\"option\",{value:\"midnight\",children:\"midnight\"}),/*#__PURE__*/_jsx(\"option\",{value:\"monokai\",children:\"monokai\"}),/*#__PURE__*/_jsx(\"option\",{value:\"moxer\",children:\"moxer\"}),/*#__PURE__*/_jsx(\"option\",{value:\"neat\",children:\"neat\"}),/*#__PURE__*/_jsx(\"option\",{value:\"neo\",children:\"neo\"}),/*#__PURE__*/_jsx(\"option\",{value:\"night\",children:\"night\"}),/*#__PURE__*/_jsx(\"option\",{value:\"nord\",children:\"nord\"}),/*#__PURE__*/_jsx(\"option\",{value:\"oceanic-next\",children:\"oceanic-next\"}),/*#__PURE__*/_jsx(\"option\",{value:\"panda-syntax\",children:\"panda-syntax\"}),/*#__PURE__*/_jsx(\"option\",{value:\"paraiso-dark\",children:\"paraiso-dark\"}),/*#__PURE__*/_jsx(\"option\",{value:\"paraiso-light\",children:\"paraiso-light\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pastel-on-dark\",children:\"pastel-on-dark\"}),/*#__PURE__*/_jsx(\"option\",{value:\"railscasts\",children:\"railscasts\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rubyblue\",children:\"rubyblue\"}),/*#__PURE__*/_jsx(\"option\",{value:\"seti\",children:\"seti\"}),/*#__PURE__*/_jsx(\"option\",{value:\"shadowfox\",children:\"shadowfox\"}),/*#__PURE__*/_jsx(\"option\",{value:\"solarized\",children:\"solarized\"}),/*#__PURE__*/_jsx(\"option\",{value:\"the-matrix\",children:\"the-matrix\"}),/*#__PURE__*/_jsx(\"option\",{value:\"tomorrow-night-bright\",children:\"tomorrow-night-bright\"}),/*#__PURE__*/_jsx(\"option\",{value:\"tomorrow-night-eighties\",children:\"tomorrow-night-eighties\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ttcn\",children:\"ttcn\"}),/*#__PURE__*/_jsx(\"option\",{value:\"twilight\",children:\"twilight\"}),/*#__PURE__*/_jsx(\"option\",{value:\"vibrant-ink\",children:\"vibrant-ink\"}),/*#__PURE__*/_jsx(\"option\",{value:\"xq-dark\",children:\"xq-dark\"}),/*#__PURE__*/_jsx(\"option\",{value:\"xq-light\",children:\"xq-light\"}),/*#__PURE__*/_jsx(\"option\",{value:\"yeti\",children:\"yeti\"}),/*#__PURE__*/_jsx(\"option\",{value:\"yonce\",children:\"yonce\"}),/*#__PURE__*/_jsx(\"option\",{value:\"zenburn\",children:\"zenburn\"})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn copyBtn\",onClick:copyRoomId,children:\"Copy ROOM ID\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn leaveBtn\",onClick:leaveRoom,children:\"Leave\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"editorWrap\",children:/*#__PURE__*/_jsx(Editor,{socketRef:socketRef,roomId:roomId,onCodeChange:function onCodeChange(code){codeRef.current=code;}})})]});};export default EditorPage;","map":{"version":3,"sources":["/Users/jeevansatyam/Desktop/realtime-code-editor-main/src/pages/EditorPage.js"],"names":["React","useState","useRef","useEffect","toast","Client","Editor","language","cmtheme","useRecoilState","ACTIONS","initSocket","useLocation","useNavigate","Navigate","useParams","EditorPage","lang","setLang","them","setThem","clients","setClients","socketRef","codeRef","location","roomId","reactNavigator","init","handleErrors","e","console","log","error","current","on","err","emit","JOIN","username","state","JOINED","socketId","success","SYNC_CODE","code","DISCONNECTED","prev","filter","client","off","disconnect","copyRoomId","navigator","clipboard","writeText","leaveRoom","map","target","value","window","reload"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport toast from \"react-hot-toast\";\nimport Client from \"../components/Client\";\nimport Editor from \"../components/Editor\";\nimport { language, cmtheme } from \"../../src/atoms\";\nimport { useRecoilState } from \"recoil\";\nimport ACTIONS from \"../Actions\";\nimport { initSocket } from \"../socket\";\nimport {\n  useLocation,\n  useNavigate,\n  Navigate,\n  useParams,\n} from \"react-router-dom\";\n\nconst EditorPage = () => {\n  const [lang, setLang] = useRecoilState(language);\n  const [them, setThem] = useRecoilState(cmtheme);\n\n  const [clients, setClients] = useState([]);\n\n  const socketRef = useRef(null);\n  const codeRef = useRef(null);\n  const location = useLocation();\n  const { roomId } = useParams();\n  const reactNavigator = useNavigate();\n\n  useEffect(() => {\n    const init = async () => {\n      socketRef.current = await initSocket();\n      socketRef.current.on(\"connect_error\", (err) => handleErrors(err));\n      socketRef.current.on(\"connect_failed\", (err) => handleErrors(err));\n\n      function handleErrors(e) {\n        console.log(\"socket error\", e);\n        toast.error(\"Socket connection failed, try again later.\");\n        reactNavigator(\"/\");\n      }\n\n      socketRef.current.emit(ACTIONS.JOIN, {\n        roomId,\n        username: location.state?.username,\n      });\n\n      // Listening for joined event\n      socketRef.current.on(\n        ACTIONS.JOINED,\n        ({ clients, username, socketId }) => {\n          if (username !== location.state?.username) {\n            toast.success(`${username} joined the room.`);\n            console.log(`${username} joined`);\n          }\n          setClients(clients);\n          socketRef.current.emit(ACTIONS.SYNC_CODE, {\n            code: codeRef.current,\n            socketId,\n          });\n        }\n      );\n\n      // Listening for disconnected\n      socketRef.current.on(ACTIONS.DISCONNECTED, ({ socketId, username }) => {\n        toast.success(`${username} left the room.`);\n        setClients((prev) => {\n          return prev.filter((client) => client.socketId !== socketId);\n        });\n      });\n    };\n    init();\n    return () => {\n      socketRef.current.off(ACTIONS.JOINED);\n      socketRef.current.off(ACTIONS.DISCONNECTED);\n      socketRef.current.disconnect();\n    };\n  }, []);\n\n  async function copyRoomId() {\n    try {\n      await navigator.clipboard.writeText(roomId);\n      toast.success(\"Room ID has been copied to your clipboard\");\n    } catch (err) {\n      toast.error(\"Could not copy the Room ID\");\n      console.error(err);\n    }\n  }\n\n  function leaveRoom() {\n    reactNavigator(\"/\");\n  }\n\n  if (!location.state) {\n    return <Navigate to=\"/\" />;\n  }\n\n  return (\n    <div className=\"mainWrap\">\n      <div className=\"aside\">\n        <div className=\"asideInner\">\n          <div className=\"logo\">\n            <img className=\"logoImage\" src=\"/code-sync.png\" alt=\"logo\" />\n          </div>\n          <h3>Connected</h3>\n          <div className=\"clientsList\">\n            {clients.map((client) => (\n              <Client key={client.socketId} username={client.username} />\n            ))}\n          </div>\n        </div>\n\n        <label>\n          Select Language:\n          <select\n            value={lang}\n            onChange={(e) => {\n              setLang(e.target.value);\n              window.location.reload();\n            }}\n            className=\"seLang\"\n          >\n            <option value=\"clike\">C / C++ / C#</option>\n            <option value=\"css\">CSS</option>\n            <option value=\"dart\">Dart</option>\n            <option value=\"django\">Django</option>\n            <option value=\"dockerfile\">Dockerfile</option>\n            <option value=\"go\">Go</option>\n            <option value=\"htmlmixed\">HTML-mixed</option>\n            <option value=\"javascript\">JavaScript</option>\n            <option value=\"jsx\">JSX</option>\n            <option value=\"markdown\">Markdown</option>\n            <option value=\"php\">PHP</option>\n            <option value=\"python\">Python</option>\n            <option value=\"r\">R</option>\n            <option value=\"rust\">Rust</option>\n            <option value=\"ruby\">Ruby</option>\n            <option value=\"sass\">Sass</option>\n            <option value=\"shell\">Shell</option>\n            <option value=\"sql\">SQL</option>\n            <option value=\"swift\">Swift</option>\n            <option value=\"xml\">XML</option>\n            <option value=\"yaml\">yaml</option>\n          </select>\n        </label>\n\n        <label>\n          Select Theme:\n          <select\n            value={them}\n            onChange={(e) => {\n              setThem(e.target.value);\n              window.location.reload();\n            }}\n            className=\"seLang\"\n          >\n            <option value=\"default\">default</option>\n            <option value=\"3024-day\">3024-day</option>\n            <option value=\"3024-night\">3024-night</option>\n            <option value=\"abbott\">abbott</option>\n            <option value=\"abcdef\">abcdef</option>\n            <option value=\"ambiance\">ambiance</option>\n            <option value=\"ayu-dark\">ayu-dark</option>\n            <option value=\"ayu-mirage\">ayu-mirage</option>\n            <option value=\"base16-dark\">base16-dark</option>\n            <option value=\"base16-light\">base16-light</option>\n            <option value=\"bespin\">bespin</option>\n            <option value=\"blackboard\">blackboard</option>\n            <option value=\"cobalt\">cobalt</option>\n            <option value=\"colorforth\">colorforth</option>\n            <option value=\"darcula\">darcula</option>\n            <option value=\"duotone-dark\">duotone-dark</option>\n            <option value=\"duotone-light\">duotone-light</option>\n            <option value=\"eclipse\">eclipse</option>\n            <option value=\"elegant\">elegant</option>\n            <option value=\"erlang-dark\">erlang-dark</option>\n            <option value=\"gruvbox-dark\">gruvbox-dark</option>\n            <option value=\"hopscotch\">hopscotch</option>\n            <option value=\"icecoder\">icecoder</option>\n            <option value=\"idea\">idea</option>\n            <option value=\"isotope\">isotope</option>\n            <option value=\"juejin\">juejin</option>\n            <option value=\"lesser-dark\">lesser-dark</option>\n            <option value=\"liquibyte\">liquibyte</option>\n            <option value=\"lucario\">lucario</option>\n            <option value=\"material\">material</option>\n            <option value=\"material-darker\">material-darker</option>\n            <option value=\"material-palenight\">material-palenight</option>\n            <option value=\"material-ocean\">material-ocean</option>\n            <option value=\"mbo\">mbo</option>\n            <option value=\"mdn-like\">mdn-like</option>\n            <option value=\"midnight\">midnight</option>\n            <option value=\"monokai\">monokai</option>\n            <option value=\"moxer\">moxer</option>\n            <option value=\"neat\">neat</option>\n            <option value=\"neo\">neo</option>\n            <option value=\"night\">night</option>\n            <option value=\"nord\">nord</option>\n            <option value=\"oceanic-next\">oceanic-next</option>\n            <option value=\"panda-syntax\">panda-syntax</option>\n            <option value=\"paraiso-dark\">paraiso-dark</option>\n            <option value=\"paraiso-light\">paraiso-light</option>\n            <option value=\"pastel-on-dark\">pastel-on-dark</option>\n            <option value=\"railscasts\">railscasts</option>\n            <option value=\"rubyblue\">rubyblue</option>\n            <option value=\"seti\">seti</option>\n            <option value=\"shadowfox\">shadowfox</option>\n            <option value=\"solarized\">solarized</option>\n            <option value=\"the-matrix\">the-matrix</option>\n            <option value=\"tomorrow-night-bright\">tomorrow-night-bright</option>\n            <option value=\"tomorrow-night-eighties\">\n              tomorrow-night-eighties\n            </option>\n            <option value=\"ttcn\">ttcn</option>\n            <option value=\"twilight\">twilight</option>\n            <option value=\"vibrant-ink\">vibrant-ink</option>\n            <option value=\"xq-dark\">xq-dark</option>\n            <option value=\"xq-light\">xq-light</option>\n            <option value=\"yeti\">yeti</option>\n            <option value=\"yonce\">yonce</option>\n            <option value=\"zenburn\">zenburn</option>\n          </select>\n        </label>\n\n        <button className=\"btn copyBtn\" onClick={copyRoomId}>\n          Copy ROOM ID\n        </button>\n        <button className=\"btn leaveBtn\" onClick={leaveRoom}>\n          Leave\n        </button>\n      </div>\n\n      <div className=\"editorWrap\">\n        <Editor\n          socketRef={socketRef}\n          roomId={roomId}\n          onCodeChange={(code) => {\n            codeRef.current = code;\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default EditorPage;\n"]},"metadata":{},"sourceType":"module"}